<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Awarded Goods — 3D (No-CDN Fallback)</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  <link rel="stylesheet" href="./style.css"/>
  <style>
    /* Extra tiny tweaks for this fallback */
    #scene { background: #000; }
    #logoWrap {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) perspective(1000px);
      width: clamp(220px, 30vw, 520px);
      height: clamp(220px, 30vw, 520px);
      display: grid;
      place-items: center;
      pointer-events: none; /* buttons/mouse drag handled on overlay */
    }
    #logo3d {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      filter: drop-shadow(0 10px 30px rgba(212,175,55,0.35));
      will-change: transform;
    }
    /* Transparent overlay to capture drag */
    #dragger {
      position: fixed; inset: 0; 
      cursor: grab; 
      background: transparent;
    }
    #dragger:active { cursor: grabbing; }
  </style>
</head>
<body>
  <div id="ui">
    <div class="brand">Awarded Goods</div>
    <div class="nav">
      <button data-view="top">Top</button>
      <button data-view="bottom">Bottom</button>
      <button data-view="left">Left</button>
      <button data-view="right">Right</button>
      <button data-view="home" class="primary">Home</button>
    </div>
  </div>

  <!-- Starfield canvas -->
  <canvas id="scene"></canvas>

  <!-- 3D-ish logo (CSS transforms, no libs) -->
  <div id="logoWrap">
    <img id="logo3d" src="./assets/logo.svg" alt="Awarded Goods Logo"/>
  </div>

  <!-- Transparent overlay to capture drag inputs -->
  <div id="dragger"></div>

  <script>
    /* === Starfield (Canvas 2D) === */
    const canvas = document.getElementById('scene');
    const ctx = canvas.getContext('2d');
    let w, h, dpr;
    function resize() {
      w = window.innerWidth; h = window.innerHeight; dpr = Math.min(window.devicePixelRatio || 1, 2);
      canvas.width = w * dpr; canvas.height = h * dpr;
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    window.addEventListener('resize', resize); resize();

    // Generate stars
    const STAR_COUNT = 1400;
    const stars = new Array(STAR_COUNT).fill(0).map(() => ({
      x: (Math.random() - 0.5) * 2,
      y: (Math.random() - 0.5) * 2,
      z: Math.random(),
      s: Math.random() * 1.4 + 0.2
    }));

    function renderStars(t) {
      ctx.clearRect(0, 0, w, h);
      // gradient background for "nebula"
      const g = ctx.createLinearGradient(0,0,w,h);
      g.addColorStop(0, '#0a0a1a');
      g.addColorStop(1, '#1a0033');
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);

      ctx.save();
      ctx.translate(w/2, h/2);

      const rot = t * 0.00005;
      const cos = Math.cos(rot), sin = Math.sin(rot);

      for (const st of stars) {
        // simple "orbit"
        const rx = st.x * cos - st.y * sin;
        const ry = st.x * sin + st.y * cos;
        const depth = (st.z * 0.9 + 0.1);
        const sx = rx * w * 0.45 * depth;
        const sy = ry * h * 0.45 * depth;
        const alpha = 0.25 + (1 - depth) * 0.75;

        ctx.globalAlpha = alpha;
        ctx.fillStyle = '#FFFFFF';
        ctx.beginPath();
        ctx.arc(sx, sy, st.s, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.restore();
      ctx.globalAlpha = 1;
    }

    /* === Logo 3D-like interaction (CSS transforms) === */
    const logo = document.getElementById('logo3d');
    let rotX = 10, rotY = -12; // degrees
    let targetX = rotX, targetY = rotY;

    function applyTransform() {
      // subtle “extrusion” illusion with 3D rotate and scale
      logo.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
    }
    applyTransform();

    // Buttons move “camera” to presets
    const presets = {
      home:  { x: 10,  y: -12 },
      top:   { x: 55,  y: 0    },
      bottom:{ x: -35, y: 0    },
      left:  { x: 0,   y: -60  },
      right: { x: 0,   y: 60   }
    };
    document.querySelectorAll('button[data-view]').forEach(btn => {
      btn.addEventListener('click', () => {
        const p = presets[btn.dataset.view] || presets.home;
        targetX = p.x; targetY = p.y;
      });
    });

    // Drag to rotate
    const dragger = document.getElementById('dragger');
    let dragging = false, lastX = 0, lastY = 0;
    dragger.addEventListener('mousedown', e => { dragging = true; lastX = e.clientX; lastY = e.clientY; });
    window.addEventListener('mouseup', () => dragging = false);
    window.addEventListener('mousemove', e => {
      if (!dragging) return;
      const dx = e.clientX - lastX;
      const dy = e.clientY - lastY;
      lastX = e.clientX; lastY = e.clientY;
      targetY += dx * 0.2;   // yaw
      targetX -= dy * 0.2;   // pitch
    });

    // Touch support
    dragger.addEventListener('touchstart', e => {
      if (!e.touches[0]) return; 
      dragging = true; const t = e.touches[0]; lastX = t.clientX; lastY = t.clientY;
    }, {passive:true});
    window.addEventListener('touchend', () => dragging = false, {passive:true});
    window.addEventListener('touchmove', e => {
      if (!dragging || !e.touches[0]) return;
      const t = e.touches[0];
      const dx = t.clientX - lastX;
      const dy = t.clientY - lastY;
      lastX = t.clientX; lastY = t.clientY;
      targetY += dx * 0.2;
      targetX -= dy * 0.2;
    }, {passive:true});

    // Smoothly interpolate toward targets
    function animate(t=0) {
      renderStars(t);

      // ease toward target rotation
      rotX += (targetX - rotX) * 0.1;
      rotY += (targetY - rotY) * 0.1;
      applyTransform();

      requestAnimationFrame(animate);
    }
    animate();
  </script>
</body>
</html>
